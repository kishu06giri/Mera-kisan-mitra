<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wheat Disease Detector — Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#071627; --bg2:#063b4a; --card: rgba(255,255,255,0.03);
      --accent1:#f59e0b; --accent2:#10b981; --muted:#9fb0c8; --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#e8f4ff;min-height:100vh}
    .container{max-width:1100px;margin:0 auto;padding:28px}
    nav{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(90deg,var(--accent2),var(--accent1));display:grid;place-items:center;color:#042028;font-weight:800}
    .navlinks{display:flex;gap:12px}
    .navlinks a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:8px}
    .navlinks a.active, .navlinks a:hover{background:var(--glass);color:#fff}

    .hero{display:grid;grid-template-columns:1fr 420px;gap:24px;align-items:center;margin-top:20px}
    @media(max-width:980px){.hero{grid-template-columns:1fr;padding-bottom:20px}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:22px;border-radius:14px;box-shadow:0 14px 60px rgba(2,6,23,0.6)}
    h1{margin:0;font-size:28px}
    p.lead{margin:10px 0 0;color:var(--muted)}

    .cta{margin-top:16px;display:flex;gap:12px}
    .btn{background:linear-gradient(90deg,var(--accent1),#f97316);border:none;color:#07203b;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}

    /* features */
    .features{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:18px}
    @media(max-width:980px){.features{grid-template-columns:1fr}}
    .feature{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px}
    .feature h4{margin:0 0 6px}
    .muted{color:var(--muted)}

    /* sections */
    section{margin-top:26px}
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    @media(max-width:980px){.two-col{grid-template-columns:1fr}}

    /* team */
    .team{display:flex;gap:12px;flex-wrap:wrap}
    .member{background:var(--card);padding:12px;border-radius:10px;width:220px}
    .member h5{margin:6px 0}

    /* footer */
    footer{margin-top:30px;text-align:center;color:var(--muted);padding:20px}

    /* model page styles */
    .model-wrap{display:grid;grid-template-columns:1fr 380px;gap:18px}
    @media(max-width:980px){.model-wrap{grid-template-columns:1fr}}

    /* reuse upload styles */
    .drop{border-radius:12px;padding:18px;border:2px dashed rgba(255,255,255,0.04);display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer}
    .drop.drag{border-color:rgba(255,255,255,0.1)}
    .preview img{max-width:100%;border-radius:10px}
    .result{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px}

    /* small utilities */
    .label{font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <nav>
      <div class="brand">
        <div class="logo">W</div>
        <div>
          <div style="font-weight:700">Wheat Detector</div>
          <div style="font-size:12px;color:var(--muted)">AI for Agriculture</div>
        </div>
      </div>
      <div class="navlinks">
        <a href="#home" class="navlink active">Home</a>
        <a href="#model" class="navlink">Model</a>
        <a href="#details" class="navlink">Project</a>
        <a href="#team" class="navlink">Team</a>
      </div>
    </nav>

    <!-- HOME -->
    <main id="home">
      <div class="hero">
        <div class="card">
          <h1>Detect wheat diseases instantly — from a photo</h1>
          <p class="lead">A lightweight, accurate MobileNetV2-based model that identifies wheat leaf diseases and provides treatment suggestions and cost estimates. Built for farmers and extension workers.</p>
          <div class="cta">
            <button class="btn" id="goModel">Try the Model</button>
            <button class="btn secondary" id="learnMore">Learn More</button>
          </div>

          <div class="features" style="margin-top:18px">
            <div class="feature"><h4>Fast Inference</h4><div class="muted">Optimized for low latency</div></div>
            <div class="feature"><h4>Practical Advice</h4><div class="muted">Dosage & cost estimates</div></div>
            <div class="feature"><h4>Mobile Ready</h4><div class="muted">Lightweight model for edge later</div></div>
          </div>
        </div>

        <aside class="card" style="display:flex;flex-direction:column;gap:12px">
          <div style="font-weight:700">Quick Stats</div>
          <div class="label">Model: <strong>MobileNetV2</strong></div>
          <div class="label">Classes: <strong>~45</strong></div>
          <div class="label">Deployment: <strong>Render (backend)</strong></div>
          <div class="label">Frontend: <strong>Static HTML</strong></div>
          <div style="margin-top:auto"><button class="btn" id="demoBtn">Live Demo</button></div>
        </aside>
      </div>

      <section id="details">
        <div class="two-col">
          <div class="card">
            <h3>Project Overview</h3>
            <p class="muted">This project automates early detection of wheat diseases using computer vision. Farmers can upload a photo of a leaf and receive an instant diagnosis and recommended treatments with dosage and cost estimates. The backend uses PyTorch and FastAPI, while the frontend is a lightweight HTML app for easy access.</p>
            <h4 style="margin-top:12px">How it helps</h4>
            <ul class="muted">
              <li>Faster diagnosis</li>
              <li>Lower cost due to targeted treatment</li>
              <li>Easy access via smartphones</li>
            </ul>
          </div>

          <div class="card">
            <h3>Technical Summary</h3>
            <p class="muted">Transfer-learning on MobileNetV2 with standard preprocessing and augmentations. Training done on Colab/GPU. Model exported as .pth and loaded by FastAPI for inference. Treatment mapping provides pesticide suggestions.</p>
            <h4 style="margin-top:12px">Pipeline</h4>
            <ol class="muted">
              <li>Image upload</li>
              <li>Preprocessing</li>
              <li>Model prediction</li>
              <li>Treatment mapping</li>
            </ol>
          </div>
        </div>
      </section>

      <section id="team" style="margin-top:20px">
        <h3>Team</h3>
        <div class="team">
          <div class="member card"><h5>Abhishek Kahate</h5><div class="muted">ML & Backend</div><div class="muted">Role: model training, API</div></div>
          <div class="member card"><h5>Tanhvi Shanware</h5><div class="muted">Frontend & UX</div><div class="muted">Role: UI, deployment</div></div>
          <div class="member card"><h5>Krish Giri</h5><div class="muted">Data & Testing</div><div class="muted">Role: dataset curation</div></div>
        </div>
      </section>

    </main>

    <!-- MODEL PAGE -->
    <section id="modelPage" style="display:none;margin-top:18px">
      <div class="model-wrap">
        <div class="card">
          <h2>Model — Predict & Recommend</h2>
          <p class="muted">Upload image of a wheat leaf. The model predicts disease and returns suggested treatment with dosage and cost estimate.</p>

          <div id="dropModel" class="drop" tabindex="0">
            <div style="font-weight:700">Drop or click to upload</div>
            <div class="muted">Supported: JPG, PNG</div>
            <input id="fileModel" type="file" accept="image/*" style="display:none">
          </div>

          <div style="margin-top:12px;display:flex;gap:10px;align-items:center">
            <button id="predictModel" class="btn">Predict</button>
            <button id="clearModel" class="btn secondary">Clear</button>
            <div style="margin-left:auto" class="muted">Backend: <strong>https://wheat-backend.onrender.com</strong></div>
          </div>

          <div id="statusModel" class="muted" style="margin-top:10px"></div>
          <div id="infoModel" class="result" style="margin-top:12px;display:none"></div>
        </div>

        <aside class="card preview">
          <div style="font-weight:700">Preview</div>
          <div id="previewModel" style="width:100%;min-height:220px;display:grid;place-items:center;color:var(--muted)">No image</div>

          <div id="predictionsModel" style="margin-top:10px;display:none"></div>
        </aside>
      </div>

      <div style="margin-top:18px" class="card">
        <h3>Model Details & Notes</h3>
        <p class="muted">MobileNetV2 fine-tuned on wheat dataset. Preprocessing: resize 256 → center-crop 224, image normalization using ImageNet stats. Use advised dose & cost estimates as guidance only.</p>
      </div>
    </section>

    <footer>© 2025 Wheat Detector • Built with ❤️ • Disclaimer: Consult local agronomist for final decisions.</footer>
  </div>

<script>
// Simple client-side navigation + model frontend logic
const navlinks = document.querySelectorAll('.navlink');
const homeSection = document.getElementById('home');
const modelPage = document.getElementById('modelPage');
const modelLink = document.querySelector('a[href="#model"]');

function showHome(){ homeSection.style.display='block'; modelPage.style.display='none'; document.querySelectorAll('.navlink').forEach(a=>a.classList.remove('active')); document.querySelector('a[href="#home"]').classList.add('active'); }
function showModel(){ homeSection.style.display='none'; modelPage.style.display='block'; document.querySelectorAll('.navlink').forEach(a=>a.classList.remove('active')); modelLink.classList.add('active'); }

// nav events
document.getElementById('goModel').addEventListener('click', showModel);
document.getElementById('learnMore').addEventListener('click', ()=>{ location.hash='#details'; window.scrollTo({top:250, behavior:'smooth'}) });
modelLink.addEventListener('click', (e)=>{ e.preventDefault(); showModel(); });
document.querySelector('a[href="#home"]').addEventListener('click', (e)=>{ e.preventDefault(); showHome(); });

// Model upload logic (uses same backend as earlier)
const BACKEND = 'https://wheat-backend.onrender.com/predict';
const dropModel = document.getElementById('dropModel');
const fileModel = document.getElementById('fileModel');
const previewModel = document.getElementById('previewModel');
const predictModel = document.getElementById('predictModel');
const clearModel = document.getElementById('clearModel');
const statusModel = document.getElementById('statusModel');
const infoModel = document.getElementById('infoModel');
const predictionsModel = document.getElementById('predictionsModel');
let selectedFileModel = null;

['dragenter','dragover'].forEach(ev=>dropModel.addEventListener(ev,e=>{ e.preventDefault(); dropModel.classList.add('drag'); statusModel.textContent='Drop to upload'; }));
['dragleave','drop'].forEach(ev=>dropModel.addEventListener(ev,e=>{ e.preventDefault(); dropModel.classList.remove('drag'); statusModel.textContent=''; }));

dropModel.addEventListener('drop',(e)=>{ e.preventDefault(); const f = e.dataTransfer.files && e.dataTransfer.files[0]; if(f) handleModelFile(f); });
dropModel.addEventListener('click', ()=> fileModel.click());
fileModel.addEventListener('change', ()=> { const f = fileModel.files[0]; if(f) handleModelFile(f); });

function handleModelFile(file){ selectedFileModel = file; previewModel.innerHTML=''; const img = document.createElement('img'); img.src = URL.createObjectURL(file); img.onload = ()=> URL.revokeObjectURL(img.src); img.style.maxHeight='220px'; previewModel.appendChild(img); infoModel.style.display='none'; predictionsModel.style.display='none'; }

clearModel.addEventListener('click', ()=>{ selectedFileModel=null; previewModel.innerHTML='No image'; infoModel.style.display='none'; predictionsModel.style.display='none'; fileModel.value=''; statusModel.textContent=''; });

predictModel.addEventListener('click', async ()=>{
  if(!selectedFileModel){ statusModel.textContent='Please choose an image first'; return; }
  statusModel.textContent='Uploading...'; predictModel.disabled = true; predictModel.textContent='Predicting...';
  try{
    const fd = new FormData(); fd.append('file', selectedFileModel);
    const res = await fetch(BACKEND, { method:'POST', body: fd });
    if(!res.ok){ const txt = await res.text(); throw new Error('Server error: '+res.status+' '+txt); }
    const j = await res.json();
    renderModelResult(j);
    statusModel.textContent='Done';
  }catch(err){ console.error(err); statusModel.textContent='Error: '+err.message; infoModel.style.display='block'; infoModel.innerHTML = '<div style="color:#ffdede">'+err.message+'</div>'; }
  finally{ predictModel.disabled=false; predictModel.textContent='Predict'; }
});

function renderModelResult(j){ predictionsModel.innerHTML=''; if(j.predictions && j.predictions.length){ j.predictions.forEach(p=>{
  const el = document.createElement('div'); el.style.marginBottom='10px'; el.innerHTML = `<div style="display:flex;justify-content:space-between"><div style='font-weight:700'>${p.class}</div><div class='label'>${(p.confidence*100).toFixed(2)}%</div></div><div class='bar' style='margin-top:6px'><i style='width:${Math.max(4,Math.min(100,p.confidence*100))}%'></i></div>`;
  predictionsModel.appendChild(el);
 }); predictionsModel.style.display='block'; } else { predictionsModel.innerHTML='<div class="label">No predictions returned</div>'; predictionsModel.style.display='block'; }

 // treatment
 if(j.treatment){ infoModel.style.display='block'; let t = j.treatment; let html = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>Suggested treatment</strong><div class='label' style='margin-top:6px'>${t.pathogen_type||''}</div></div><div class='label'>Estimate: ${t.cost_estimate?('₹'+t.cost_estimate.min_inr+' - ₹'+t.cost_estimate.max_inr):'N/A'}</div></div><div style='margin-top:10px'>`;
 t.recommended.forEach(r=>{ html += `<div class='result' style='margin-bottom:8px'><div style='display:flex;justify-content:space-between'><div style='font-weight:700'>${r.ai} <span class='label' style='color:var(--muted)'>(${r.formulation||''})</span></div><div class='label'>PHI: ${r.phi_days||'N/A'}</div></div><div class='label' style='margin-top:6px'>Dose: ${r.dose_per_ha|| (r.dose_min? (r.dose_min+' - '+r.dose_max+' '+(r.unit||'')) : 'Refer label')}</div>`; if(r.cost_estimate) html+=`<div class='label' style='margin-top:6px'>Cost/ha: ₹${r.cost_estimate.cost_min_inr||r.cost_estimate.min_inr||'N/A'} - ₹${r.cost_estimate.cost_max_inr||r.cost_estimate.max_inr||'N/A'}</div>`; if(r.safety) html+=`<div class='label' style='margin-top:6px;color:#ffdede'>Safety: ${r.safety}</div>`; html+=`</div>` }); html += `</div><div class='label' style='margin-top:8px;color:var(--muted)'>Note: Consult local agronomist before applying any treatment.</div>`; infoModel.innerHTML = html; }
}

// initial show home
showHome();
</script>
</body>
</html>
